<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="You can either travel or read,but either your body or soul must be on the way."><title>GGSTU | Good Good Study</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">GGSTU</h1><a id="logo" href="/.">GGSTU</a><p class="description">Good Good Study</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/music/"><i class="fa fa-music"> 音乐</i></a><a href="/movie/"><i class="fa fa-film"> 电影</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/comment/"><i class="fa fa-comment"> 留言</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title"><a href="/2018/09/30/Spark-SQL中的JSON数据源/">Spark SQL中的JSON数据源</a></h1><div class="post-meta">2018-09-30</div><div class="post-content"><p>Spark SQL可以自动推断JSON文件的元数据，并且加载其数据，创建一个DataFrame。<br>可以使用SparkSession.read.json()方法，针对一个元素类型为String的RDD，或者是一个JSON文件创建DataFrame。</p>
<p>这里使用的JSON文件，每行必须只能包含一个单独的、自包含的、有效的JSON对象。不能让一个JSON对象分散在多行。否则会报错。<br></div><p class="readmore"><a href="/2018/09/30/Spark-SQL中的JSON数据源/">阅读全文</a></p></div><div class="post"><h1 class="post-title"><a href="/2018/09/29/Spark-SQL中的Parquet数据源/">Spark SQL中的Parquet数据源</a></h1><div class="post-meta">2018-09-29</div><div class="post-content"><p><font size="4"><b>什么是Parquet文件？</b></font><br>Parquet是列式存储格式的一种文件类型。列式存储和行式存储相比有如下优势：<br>1、可以跳过不符合条件的数据，只读取需要的数据，降低IO数据量。<br>2、压缩编码可以降低磁盘存储空间。由于同一列的数据类型是一样的，可以使用更高效的压缩编码(如Run Length Encoding和Delta Encoding)进一步节约存储空间。<br>3、只读取需要的列，支持向量运算，能过获取更好的扫描性能。<br></div><p class="readmore"><a href="/2018/09/29/Spark-SQL中的Parquet数据源/">阅读全文</a></p></div><div class="post"><h1 class="post-title"><a href="/2018/09/28/Spark-SQL之通用的Load-Save操作/">Spark SQL之通用的Load/Save操作</a></h1><div class="post-meta">2018-09-28</div><div class="post-content"><p><font size="4"><b>通用的Load/Save操作</b></font><br>对于Spark SQL的DataFrame来说，无论是从什么数据源创建出来的DataFrame，都有一些共同的load和save操作。load操作主要用于加载数据，创建出DataFrame。save操作，主要用于将DataFrame中的数据保存到文件中。<br>这里以spark官方包提供的示例文件users.parquet为例，将其下载到本地<br><a href="https://github.com/apache/spark/blob/master/examples/src/main/resources/users.parquet" target="_blank">https://github.com/apache/spark/blob/master/examples/src/main/resources/users.parquet</a><br></div><p class="readmore"><a href="/2018/09/28/Spark-SQL之通用的Load-Save操作/">阅读全文</a></p></div><div class="post"><h1 class="post-title"><a href="/2018/09/28/Spark-SQL之将RDD转换成Datasets的两种方式/">Spark SQL之将RDD转换成Datasets的两种方式</a></h1><div class="post-meta">2018-09-28</div><div class="post-content"><p>将RDD转换成Datasets，就可以直接针对集合、本地文件、HDFS等任何可以构建为RDD的数据，使用SparkSQL进行SQL查询。</p>
<p><b>Spark SQL支持两种方式来将RDD转换成Datasets：</b></p>
<p>第一种方法使用反射来推断包含了特定数据类型的RDD的元数据。这种基于反射的方式，代码比较简洁。如果知道RDD的元数据时，使用这种方式比较好。<br></div><p class="readmore"><a href="/2018/09/28/Spark-SQL之将RDD转换成Datasets的两种方式/">阅读全文</a></p></div><div class="post"><h1 class="post-title"><a href="/2018/09/26/Spark-SQL之创建Datasets/">Spark SQL之创建Datasets</a></h1><div class="post-meta">2018-09-26</div><div class="post-content"><p>DataFrame的引入，可以让Spark更好的处理结构数据的计算，但其中一个主要的问题是：缺乏编译时类型安全。为了解决这个问题，Spark采用新的Dataset API（DataFrame API的类型扩展）。</p>
<p>Dataset是分布式数据集合。Dataset是Spark 1.6中添加的一个接口，兼顾了RDD的优点（强类型化，使用功能强大的lambda函数）以及Spark SQL优化后的执行引擎的优点。<br></div><p class="readmore"><a href="/2018/09/26/Spark-SQL之创建Datasets/">阅读全文</a></p></div><div class="post"><h1 class="post-title"><a href="/2018/09/24/Spark-SQL之DataFrame的操作/">Spark SQL之DataFrame的操作</a></h1><div class="post-meta">2018-09-24</div><div class="post-content"><p>以下是对DataFrame进行操作的基本示例：</p>
<p>首先在本地桌面上创建个json文件，student.json，文件内容如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1, &quot;name&quot;:&quot;Tom&quot;, &quot;age&quot;:21&#125;</span><br><span class="line">&#123;&quot;id&quot;:2, &quot;name&quot;:&quot;Bob&quot;, &quot;age&quot;:25&#125;</span><br><span class="line">&#123;&quot;id&quot;:3, &quot;name&quot;:&quot;Alice&quot;, &quot;age&quot;:18&#125;</span><br><span class="line">&#123;&quot;id&quot;:4, &quot;name&quot;:&quot;Jack&quot;, &quot;age&quot;:23&#125;</span><br><span class="line">&#123;&quot;id&quot;:5, &quot;name&quot;:&quot;Jerry&quot;, &quot;age&quot;:25&#125;</span><br></pre></td></tr></table></figure></p></div><p class="readmore"><a href="/2018/09/24/Spark-SQL之DataFrame的操作/">阅读全文</a></p></div><div class="post"><h1 class="post-title"><a href="/2018/09/24/Spark-SQL之创建DataFrames/">Spark SQL之创建DataFrames</a></h1><div class="post-meta">2018-09-24</div><div class="post-content"><p>DataFrame是组织成指定列的DataSet。它在概念上等同于关系型数据库中的表，但在底层具有更丰富的优化。创建DataFrame的来源有多种，例如：结构化数据文件，Hive中的表，外部数据库或现有RDD。</p>
<p><font size="4"><b>（1）通过case class创建DataFrame</b></font><br></div><p class="readmore"><a href="/2018/09/24/Spark-SQL之创建DataFrames/">阅读全文</a></p></div><div class="post"><h1 class="post-title"><a href="/2018/09/23/2018南京森林音乐会/">2018南京森林音乐会</a></h1><div class="post-meta">2018-09-23</div><div class="post-content"><p>2018年9月23日，听了李云迪的钢琴曲，只有音乐才最纯粹吧<br>大学生活剩下不到四分之一，希望也能够纯粹的开始，纯粹的结束<br>有些事情也许早已知道结局，但也希望其中的经历能够美好的保存在记忆里<br>秋夜深，让心也静下来吧……<br></div><p class="readmore"><a href="/2018/09/23/2018南京森林音乐会/">阅读全文</a></p></div><nav class="page-navigator"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/2/">下一页</a></nav></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://www.ggstu.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术文章/">技术文章</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随便说说/">随便说说</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/心情/" style="font-size: 16.6px;">心情</a> <a href="/tags/Hadoop/" style="font-size: 14.8px;">Hadoop</a> <a href="/tags/Linux/" style="font-size: 16.6px;">Linux</a> <a href="/tags/Java/" style="font-size: 18.4px;">Java</a> <a href="/tags/Scala/" style="font-size: 20.2px;">Scala</a> <a href="/tags/Spark/" style="font-size: 22px;">Spark</a> <a href="/tags/健身/" style="font-size: 13px;">健身</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/09/30/Spark-SQL中的JSON数据源/">Spark SQL中的JSON数据源</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/29/Spark-SQL中的Parquet数据源/">Spark SQL中的Parquet数据源</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/28/Spark-SQL之通用的Load-Save操作/">Spark SQL之通用的Load/Save操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/28/Spark-SQL之将RDD转换成Datasets的两种方式/">Spark SQL之将RDD转换成Datasets的两种方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/26/Spark-SQL之创建Datasets/">Spark SQL之创建Datasets</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/24/Spark-SQL之DataFrame的操作/">Spark SQL之DataFrame的操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/24/Spark-SQL之创建DataFrames/">Spark SQL之创建DataFrames</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/23/2018南京森林音乐会/">2018南京森林音乐会</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/20/Spark-SQL简介/">Spark SQL简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/20/Spark-Shuffle的原理分析/">Spark Shuffle的原理分析</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a target="_blank"></a><ul></ul><a href="http://www.github.com/" title="GitHub" target="_blank">GitHub</a><ul></ul><a href="http://hadoop.apache.org/" title="Hadoop" target="_blank">Hadoop</a><ul></ul><a href="http://spark.apache.org/" title="Spark" target="_blank">Spark</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div align="center"><a href="http://www.amazingcounters.com"><img border="0" src="http://cc.amazingcounters.com/counter.php?i=3225931&c=9678106" alt="位访客"></a></div><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">GGSTU.</a> 由<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo</a> 强力驱动.主题 - <a rel="nofollow" target="_blank" href="https://github.com/pagecho/maupassant/"> maupassant</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>